<script>
function drawFlashcard() {
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    console.log(this.status);
    if (this.readyState == 4 && this.status == 200) {
     populateFlashcard(this.responseText)
    }
  };
  xhttp.open("GET", '<%= url_for(controller: 'courses', action: 'flashcard') %>', true);
  xhttp.send();
}

function populateFlashcard(json) {
  var student = JSON.parse(json);
  document.getElementById("student-name").innerHTML = student.name;
  document.getElementById("student-info").innerHTML = student.email;
}
</script>
<center>
  <br>
    <div>
      <h1> <%= @course.code %>: <%= @course.title %></h1>
      <hr>
      <div class = "container">
        <div class="row">
          <div class="col-lg-4">
            <h3> Actions</h3>
            <%= link_to "Edit Course", edit_user_course_path(@user, @course) %><br>
            <%= link_to "All Courses", user_courses_path(@user) %><br>
            <%= link_to "Account", user_path(@user) %><br>
            <%= link_to "Add Student", new_user_course_student_path(@user, @course) %><br>
            <%= link_to "Add Assignment", new_user_course_assignment_path(@user, @course) %>
          </div>
          <div class = "col-lg-4">
            <h2>Assignments</h2>
            <table>
              <thead>
                <tr><th>Name</th><th>Description</th><th>ID</th><th></th>
              </thead>
              <tbody>
                <% @course.assignments[0..5].each do |assignment| %>
                  <tr>
                    <td><%= assignment.name %></td>
                    <td><%= truncate assignment.description, length: 30, separator: /\w+/ %></td>
                    <td><%= assignment.id %></td>
                    <td><%= link_to "View", user_course_assignment_path(@user, @course, assignment) %></td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
          <div class = "col-lg-4">
            <h3>Flashcards</h3>
            <div id="flashcard-info">
              <h4 id="student-name">Name</h4>
              <p id="student-info">info</p>
              <div class="btn" onclick="drawFlashcard()">Draw Flashcard</div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-10 offset-lg-1">
          <h2>Student Roster</h2>
          <table>
            <tbody>
              <% @course.students.each do |student| %>
                <tr>
                  <td><%= student.name %></td>
                  <td><%= link_to "See Student", user_course_student_path(@user, @course, student) %></td>
                </tr>
              <% end %>
            </tbody>
          </table>
          </div>
        </div>
      </div>
    </div>
